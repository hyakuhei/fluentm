digraph "Attacker deploys exploit for CVE-2019-5376" {
	color=blue fontname=Arial rankdir=LR
	node [fontname=Arial fontsize=11 shape=box style=rounded]
	edge [fontname=Arial fontsize=11]
	subgraph cluster_Internet {
		graph [color=red fontname=Arial fontsize=11 label=Internet style=dashed]
		Researcher
	}
	subgraph cluster_Azure {
		graph [color=red fontname=Arial fontsize=11 label=Azure style=dashed]
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
		}
	}
	subgraph cluster_Azure {
		graph [color=red fontname=Arial fontsize=11 label=Azure style=dashed]
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
			}
		}
	}
	subgraph cluster_Azure {
		graph [color=red fontname=Arial fontsize=11 label=Azure style=dashed]
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
					subgraph "cluster_RunC Container Boundary" {
						graph [color=red fontname=Arial fontsize=11 label="RunC Container Boundary" style=dashed]
						"Breakout Pod"
					}
				}
			}
		}
	}
	subgraph cluster_Azure {
		graph [color=red fontname=Arial fontsize=11 label=Azure style=dashed]
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
					subgraph "cluster_RunC Container Boundary" {
						graph [color=red fontname=Arial fontsize=11 label="RunC Container Boundary" style=dashed]
						"Breakout Pod"
					}
				}
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				"Kube-API"
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
					subgraph "cluster_RunC Container Boundary" {
						graph [color=red fontname=Arial fontsize=11 label="RunC Container Boundary" style=dashed]
						"Breakout Pod"
					}
				}
			}
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
				}
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
					subgraph "cluster_RunC Container Boundary" {
						graph [color=red fontname=Arial fontsize=11 label="RunC Container Boundary" style=dashed]
						"Breakout Pod"
					}
				}
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					Kubelet
					subgraph "cluster_RunC Container Boundary" {
						graph [color=red fontname=Arial fontsize=11 label="RunC Container Boundary" style=dashed]
						"Breakout Pod"
					}
					RootShell
				}
			}
		}
	}
	Researcher -> "Kube-API" [label="(1) Deploy breakout pod"]
	"Kube-API" -> Kubelet [label="(2) Deploy Breakout Pod"]
	Kubelet -> "Breakout Pod" [label="(3) Deploy"]
	"Breakout Pod" -> RootShell [label="(4) Root shell"]
	RootShell -> Researcher [label="(5) Reverse shell connection"]
}
