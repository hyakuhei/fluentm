digraph "Attacker learns about cluster" {
	color=blue fontname=Arial rankdir=LR
	node [fontname=Arial fontsize=11 shape=box style=rounded]
	edge [fontname=Arial fontsize=11]
	subgraph cluster_Internet {
		graph [color=red fontname=Arial fontsize=11 label=Internet style=dashed]
		Researcher
	}
	subgraph cluster_Azure {
		graph [color=red fontname=Arial fontsize=11 label=Azure style=dashed]
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					RootShell
				}
			}
		}
	}
	subgraph cluster_Azure {
		graph [color=red fontname=Arial fontsize=11 label=Azure style=dashed]
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					RootShell
				}
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					RootShell
				}
			}
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				bridge
			}
		}
	}
	subgraph cluster_Azure {
		graph [color=red fontname=Arial fontsize=11 label=Azure style=dashed]
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					RootShell
				}
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					RootShell
				}
			}
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				bridge
			}
		}
		subgraph "cluster_ACI Data Plane" {
			graph [color=red fontname=Arial fontsize=11 label="ACI Data Plane" style=dashed]
			subgraph "cluster_K8s Data Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Data Plane" style=dashed]
				subgraph "cluster_Researcher VM" {
					graph [color=red fontname=Arial fontsize=11 label="Researcher VM" style=dashed]
					RootShell
				}
			}
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				bridge
			}
			subgraph "cluster_K8s Control Plane" {
				graph [color=red fontname=Arial fontsize=11 label="K8s Control Plane" style=dashed]
				bridge
				"Kube-API"
			}
		}
	}
	Researcher -> RootShell [label="(1) cluster recon commands"]
	RootShell -> RootShell [label="(2) Read Kubelet credentials"]
	RootShell -> bridge [label="(3) List all pods, namespaces, nodes"]
	bridge -> "Kube-API" [label="(4) List all pods, namespaces, nodes"]
	"Kube-API" -> bridge [label="(5) Cluster information"]
	bridge -> RootShell [label="(6) Cluster information"]
}
