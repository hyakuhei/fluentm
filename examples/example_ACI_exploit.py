from fluentm.entities import Actor, Process, DataFlow, HTTP, MTLS, TLS, DHCP, Unknown

import fluentm.renderer as renderer

# An example using scenes to describe how the Azure ACI exploit took place

scenes = {
    # User starts from terminal, with Azure credentials
    "Attacker looks for runtime information": [
        DataFlow(
            Actor("Researcher").inBoundary("Internet"),
            Process("ACI API").inBoundary("Azure").inBoundary("ACI Control Plane"),
            TLS(HTTP("Deploy WhoC container")),
        ),
        DataFlow(
            Process("ACI API"),
            Process("Kube-API").inBoundary("k8s control plane").inBoundary("Azure"),
            Unknown("Deploy WhoC container"),
        ),
    ]
}

if __name__ == "__main__":
    renderer.report(scenes, outputDir="aciExploit", dfdLabels=True)
